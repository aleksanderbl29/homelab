name: Automatic issue handling
on:
  workflow_dispatch:
  issues:
    types: [opened, edited, milestoned, demilestoned, closed, reopened, assigned, unassigned, labeled, unlabeled]
  push:
    paths:
      - '.github/workflows/auto-issue.yml'

permissions: # Optional
  issues: write
  pull-requests: write
  contents: write

jobs:
  # add-to-project:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: checkout
  #       uses: actions/checkout@v2
  #     - uses: actions/add-to-project@v0.5.0
  #       with:
  #         project-url: https://github.com/users/aleksanderbl29/projects/1
  #         github-token: ${{ secrets.ADD_TO_PROJECT_PAT }}
  auto-issue:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v2
      - name: rewriteReadme
        uses: seed-of-apricot/issue-list-readme@v1.1.0
        with:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
          pattern: '<!-- issueTable -->'
          labels: 'Working on it'
          state: 'open'
      - name: add
        run: git add README.md
      - name: commit
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: 'Update README.md with latest issues'
          commit_options: '--no-verify'
      - name: push
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
